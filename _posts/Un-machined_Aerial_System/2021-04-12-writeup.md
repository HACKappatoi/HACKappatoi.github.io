---
layout: post
title:  "[RITSEC CTF 21] Un-machined Aerial System"
date:   "2021-04-12"
categories: Reverse
author: eurus
---

we have an elf file. By disassembling it we have that:

```
.text:18C2     lea     rdi, format     ; "Fill in the rest of the flag: RS{"
.text:18C9     mov     eax, 0
.text:18CE     call    _printf
.text:18D3     mov     rdx, cs:stdin   ; stream
.text:18DA     lea     rax, [rbp+s]
.text:18DE     mov     esi, 14h        ; n
.text:18E3     mov     rdi, rax        ; s
.text:18E6     call    _fgets
.text:18EB     lea     rax, [rbp+s]
.text:18EF     lea     rsi, reject     ; "\n"
.text:18F6     mov     rdi, rax        ; s
.text:18F9     call    _strcspn
.text:18FE     mov     [rbp+rax+s], 0
.text:1903     lea     rax, [rbp+s]
.text:1907     mov     rsi, rax
.text:190A     lea     rdi, aTheInputtedFla ; "The inputted flag was RS{%s}"
.text:1911     mov     eax, 0
.text:1916     call    _printf
```




